@section scripts
{
    @Scripts.Render("~/bundles/Setting")
}
<div id="SettingController" ng-controller="SettingController">
    <div class="container-fluid">

        <div class="row">
            <div class="tabbable" style="padding-top: 10px">
                <ul class="nav nav-tabs padding-left-18">
                    <li class="active" ng-click="SetCurrentTab('Users')">
                        <a data-toggle="tab">
                            <i class="blue fa-user fa"></i>
                            <span>Nhân viên</span>
                        </a>
                    </li>
                    <li class="" ng-click="SetCurrentTab('Stores')">
                        <a data-toggle="tab">
                            <i class="blue fa-cog fa"></i>
                            <span>Thông tin cửa hàng</span>
                        </a>
                    </li>
                    <li class="" ng-click="SetCurrentTab('Setting')">
                        <a data-toggle="tab">
                            <i class="blue fa-cogs fa"></i>
                            <span>Thiết lập bán hàng</span>
                        </a>
                    </li>
                    <li class="" ng-click="SetCurrentTab('Prints')">
                        <a data-toggle="tab">
                            <i class="blue fa-print fa"></i>
                            <span>Quản lý mẫu in</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="tab-content no-border active">
                <div class="tab-pane active" ng-class="{active : (CurrentTab =='Users') }">
                    <div class="col-md-12" ng-if="(CurrentTab =='Users')">
                        <div class="row" style="padding-bottom: 10px; padding-top: 10px">
                            <div class="col-md-5">
                                <span grid-filter-for="Users" place-holder-message="Nhập mã, tên nhân viên"></span>
                            </div>
                            <div class="col-md-4 pull-right text-right">
                                <button class="btn btn-success btn-primary" data-toggle="modal"
                                        data-target="#userModal" ng-click="ResetUserModal()"
                                        ng-if="UserFormConfig._CanCreate">
                                    <i class="fa fa-plus white"></i>
                                    <span>Tạo nhân viên</span>
                                </button>
                            </div>
                        </div>

                        <table grid-data="Users"
                               grid-data-type="table" @*table/storedprocedure*@
                               grid-data-action="get" @*get/getall*@
                               grid-data-object="T_Master_User" @*table name or stored procedure name*@
                               grid-filter-condition="" @*must have [fieldname] for each colum field*@
                               grid-sort-condition="[UserName] ASC" @*must have [fieldname] for each colum field*@
                               grid-sum-collection="" @*must have [fieldname] for each colum field*@
                               class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th grid-defined-colum="LoginId"><span>Mã nhân viên</span></th>
                                    <th grid-defined-colum="UserName"><span>Tên nhân viên</span></th>
                                    <th grid-defined-colum="Email"><span>Email</span></th>
                                    <th grid-defined-colum="Phone"><span>Điện thoại</span></th>
                                    <th grid-defined-colum="IsActive"><span>Trạng thái</span></th>
                                    <th><span>Nhóm người dùng</span></th>
                                    <th></th>
                                    <th grid-defined-colum="UserId" class="none-display"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @*Dataset must have grid id*@
                                <tr ng-repeat="item in DataSet.Users.Data">
                                    <td ng-bind="item.LoginId"></td>
                                    <td>
                                        <span ng-bind="item.UserName" ng-if="!item.IsEditing"> </span>
                                        <input class="form-control" ng-model="item.UserName" ng-if="item.IsEditing"
                                               check-empty="" check-empty-message="Vui lòng nhập tên nhân viên."
                                               check-length="100" check-length-message="Chiều dài tối đa tên nhân viên là {0}."
                                               check-under="check-user{{item.UserId}}" />
                                    </td>
                                    <td>
                                        <span ng-bind="item.Email" ng-if="!item.IsEditing"></span>
                                        <input class="form-control" ng-model="item.Email" ng-if="item.IsEditing"
                                               check-custom="CheckEmailValid" check-custom-message="Vui lòng nhập email hợp lệ."
                                               check-under="check-user{{item.UserId}}" />
                                    </td>
                                    <td>
                                        <span ng-bind="item.Phone" ng-if="!item.IsEditing"></span>
                                        <input class="form-control" ng-model="item.Phone" ng-if="item.IsEditing"
                                               check-length="50" check-length-message="Chiều dài tối ta là {0}."
                                               check-under="check-user{{item.UserId}}" />
                                    </td>
                                    <td>
                                        <input type="checkbox" ng-true-value="1" ng-false-value="0"
                                               ng-model="item.IsActive" ng-if="item.IsEditing" />
                                        <span ng-if="item.IsActive == 1" class="label label-success">
                                            <i class="fa fa-unlock"> </i>
                                            Đang hoạt động
                                        </span>
                                        <span ng-if="item.IsActive == 0" class="label label-warning">
                                            <i class="fa fa-lock"> </i>
                                            Ngừng hoạt động
                                        </span>
                                    </td>
                                    <td class="text-center">
                                        <a ng-if="item._CanUpdate" class="blue margin-left-10" title="Lấy lại mật khẩu"
                                           data-toggle="modal" data-target="#rolesModal" ng-click="ViewUserRole(item)">
                                            <i class="fa-user-md fa"></i>
                                        </a>
                                    </td>
                                    <td>
                                        <a ng-if="item._CanUpdate" class="blue margin-left-10" title="Lấy lại mật khẩu"
                                           ng-click="RestorePassword(item)">
                                            <i class="fa-key fa"></i>
                                        </a>
                                        <a ng-if="!item.IsEditing && item._CanUpdate" class="blue margin-left-10"
                                           title="Chỉnh sửa" ng-click="item.IsEditing = true;">
                                            <i class="fa-edit fa"></i>
                                        </a>
                                        <a ng-if="item.IsEditing && item._CanUpdate" class="blue margin-left-10"
                                           title="Lưu" ng-click="SaveUser(item);">
                                            <i class="fa-save fa"></i>
                                        </a>
                                        <a ng-if="item.IsEditing" class="blue margin-left-10"
                                           title="Hủy" ng-click="item.IsEditing = false; ReloadGrid('Users')">
                                            <i class="fa-undo fa"></i>
                                        </a>
                                    </td>
                                </tr>
                                <tr ng-if="!DataSet.Users.HasRecord()">
                                    @*Edit colspan*@
                                    <td colspan="7" align="center"> Không có dữ liệu! </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="row">
                            <div class="col-md-9 pull-left">
                                <span grid-paging-for="Users"></span>
                            </div>
                            <div class="col-md-3 pull-right">
                                <span grid-page-size-for="Users"></span>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="tab-pane" ng-class="{active : (CurrentTab =='Stores') }">
                    <div class="col-md-12" ng-if="(CurrentTab =='Stores')">
                        <div class="padding-left-18" ng-init="LoadStoreForm()">
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Tên cửa hàng</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.StoreName"
                                           check-empty="" check-empty-message="Vui lòng nhập tên cửa hàng."
                                           check-length="500" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Mã cửa hàng</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.StoreCode" 
                                           check-empty="" check-empty-message="Vui lòng nhập mã cửa hàng."
                                           check-length="100" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Tên người đại diện</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.PresenterName" 
                                           check-length="100" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Số điện thoại</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.PhoneNumber" 
                                           check-length="50" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Địa chỉ cửa hàng</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.Address" 
                                           check-length="500" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Bộ danh mục</label>
                                </div>
                                <div class="col-md-4">
                                    <select class="form-control" ng-model="StoreForm.ProductGroup" 
                                            dropdown-master-table="T_Master_ProductGroups" 
                                            dropdown-value-field="ProductGroupId" dropdown-name-field="GroupName" 
                                            dropdown-empty-text="--Chọn bộ danh mục--" dropdown-empty-value=""
                                            dropdown-condition="[IsActive] = 1 and [IsParent] = 1"
                                            check-empty="" check-empty-message="Vui lòng chọn bộ danh mục."
                                            ng-disabled="!StoreForm.IsEditing"></select>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-3">
                                    <label class="control-label">Mã số thuế</label>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" ng-model="StoreForm.TaxCode" 
                                           check-length="100" check-length-message="Chiều dài tối ta là {0}."
                                           ng-disabled="!StoreForm.IsEditing"/>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-md-7 text-center">
                                    <button class="btn btn-primary margin-top-10" ng-if="!StoreForm.IsEditing"
                                            ng-click="StoreForm.IsEditing = true;">
                                        <i class="fa fa-edit"></i>
                                        <span>Chỉnh sửa</span>
                                    </button>
                                    <button class="btn btn-primary margin-top-10" ng-if="!StoreForm.IsEditing"
                                            ng-click="ResetStoreForm(); StoreForm.IsEditing = true;">
                                        <i class="fa fa-plus"></i>
                                        <span>Thêm Cửa hàng</span>
                                    </button>
                                    <button class="btn btn-default margin-top-10" ng-if="StoreForm.IsEditing"
                                            ng-click="UndoStoreForm()" >
                                        <i class="fa fa-undo"></i>
                                        <span>Trở về</span>
                                    </button>
                                    <button class="btn btn-primary margin-top-10" ng-if="StoreForm.IsEditing"
                                            ng-click="SaveStoreForm()">
                                        <i class="fa fa-save"></i>
                                        <span>Lưu</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="row col-md-12 margin-top-10">
                            <table grid-data="Stores"
                                   grid-data-type="table" @*table/storedprocedure*@
                                   grid-data-action="get" @*get/getall*@
                                   grid-data-object="T_Master_Stores" @*table name or stored procedure name*@
                                   grid-filter-condition="" @*must have [fieldname] for each colum field*@
                                   grid-sort-condition="[StoreCode] ASC" @*must have [fieldname] for each colum field*@
                                   grid-sum-collection="" @*must have [fieldname] for each colum field*@
                                   class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th grid-defined-colum="StoreCode"><span>Mã cửa hàng</span></th>
                                        <th grid-defined-colum="StoreName"><span>Tên cửa hàng</span></th>
                                        <th grid-defined-colum="PhoneNumber"><span>Số điện thoại</span></th>
                                        <th grid-defined-colum="Address"><span>Địa chỉ</span></th>
                                        <th grid-defined-colum="ProductGroup.GroupName"><span>Bộ danh mục</span></th>
                                        <th style="width: 10%"></th>
                                        <th grid-defined-colum="StoreId" class="none-display"></th>
                                        <th grid-defined-colum="ProductGroup" class="none-display"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*Dataset must have grid id*@
                                    <tr ng-repeat="item in DataSet.Stores.Data">
                                        <td>
                                            <span ng-bind="item.StoreCode" ng-if="!item.IsEditing"> </span>
                                            <input class="form-control" ng-model="item.StoreCode" ng-if="item.IsEditing"
                                                   check-empty="" check-empty-message="Vui lòng nhập mã cửa hàng."
                                                   check-length="100" check-length-message="Chiều dài tối ta là {0}."
                                                   check-under="check-store{{item.StoreId}}" />
                                        </td>
                                        <td>
                                            <span ng-bind="item.StoreName" ng-if="!item.IsEditing"></span>
                                            <input class="form-control" ng-model="item.StoreName" ng-if="item.IsEditing"
                                                   check-empty="" check-empty-message="Vui lòng nhập tên cửa hàng."
                                                   check-length="500" check-length-message="Chiều dài tối ta là {0}."
                                                   check-under="check-store{{item.StoreId}}" />
                                        </td>
                                        <td>
                                            <span ng-bind="item.PhoneNumber" ng-if="!item.IsEditing"></span>
                                            <input class="form-control" ng-model="item.PhoneNumber" ng-if="item.IsEditing"
                                                   check-length="50" check-length-message="Chiều dài tối ta là {0}."
                                                   check-under="check-store{{item.StoreId}}" />
                                        </td>
                                        <td>
                                            <span ng-bind="item.Address" ng-if="!item.IsEditing"></span>
                                            <input class="form-control" ng-model="item.Address" ng-if="item.IsEditing"
                                                   check-length="500" check-length-message="Chiều dài tối ta là {0}."
                                                   check-under="check-store{{item.StoreId}}" />
                                        </td>
                                        <td>
                                            <span ng-bind="item.GroupName" ng-if="!item.IsEditing"></span>
                                            <select class="form-control" ng-init="item.ProductGroup = item.ProductGroup + ''" ng-model="item.ProductGroup"
                                                    dropdown-master-table="T_Master_ProductGroups"
                                                    dropdown-value-field="ProductGroupId" dropdown-name-field="GroupName"
                                                    dropdown-empty-text="--Chọn bộ danh mục--" dropdown-empty-value=""
                                                    dropdown-condition="[IsActive] = 1 and [IsParent] = 1"
                                                    check-empty="" check-empty-message="Vui lòng chọn bộ danh mục."
                                                    check-under="check-store{{item.StoreId}}"
                                                    ng-show="item.IsEditing"></select>
                                        </td>
                                        <td>
                                            <a ng-if="!item.IsEditing && item._CanUpdate" class="blue margin-left-10"
                                               title="Chỉnh sửa" ng-click="item.IsEditing = true;">
                                                <i class="fa-edit fa"></i>
                                            </a>
                                            <a ng-if="item.IsEditing && item._CanUpdate" class="blue margin-left-10"
                                               title="Lưu" ng-click="SaveStoreItem(item);">
                                                <i class="fa-save fa"></i>
                                            </a>
                                            <a ng-if="item.IsEditing" class="blue margin-left-10"
                                               title="Hủy" ng-click="item.IsEditing = false; ReloadGrid('Stores')">
                                                <i class="fa-undo fa"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    <tr ng-if="!DataSet.Stores.HasRecord()">
                                        @*Edit colspan*@
                                        <td colspan="6" align="center"> Không có dữ liệu! </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="row">
                                <div class="col-md-9 pull-left">
                                    <span grid-paging-for="Stores"></span>
                                </div>
                                <div class="col-md-3 pull-right">
                                    <span grid-page-size-for="Stores"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @Html.Partial("UserModal")
    @Html.Partial("RolesModal")
</div>