<div ng-controller="CustomerController">
    <div class="container-fluid">
        <div class="row">
            <div class="tabbable" style="padding-top: 10px">
                <ul class="nav nav-tabs padding-left-18">
                    <li class="active" ng-click="SetCurrentTab('Customers')">
                        <a data-toggle="tab">
                            <i class="blue fa-user fa"></i>
                            <span ng-bind="Language.Resource.Customers"></span>
                        </a>
                    </li>
                    <li class="" ng-click="SetCurrentTab('SaleCustomers')">
                        <a data-toggle="tab">
                            <i class="blue fa-user fa"></i>
                            <span ng-bind="Language.Resource.CustomerSale"></span>
                        </a>
                    </li>
                    <li class="" ng-click="SetCurrentTab('Suppliers')">
                        <a data-toggle="tab">
                            <i class="blue fa-truck fa"></i>
                            <span ng-bind="Language.Resource.Supplier"></span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="tab-content no-border active">
                <div class="tab-pane active" ng-class="{active : (CurrentTab =='Customers') && !IsShowCustomerDetail }">
                    <div class="col-md-12" ng-if="(CurrentTab =='Customers') && !IsShowCustomerDetail">
                        <div class="row" style="padding-bottom: 10px; padding-top: 5px">
                            <div class="col-md-5 margin-top-5">
                                <span grid-filter-for="Customers" place-holder-message="{{Language.Resource.PlaceholderCustomer}}"></span>
                            </div>
                            <div class="col-md-2 col-xl-12 margin-top-5">
                                <select class="form-control input-sm" ng-model="AdditionalFilter.CustomerType" ng-change="ReloadGrid('Customers')">
                                    <option value="0" ng-bind="Language.Resource.All"></option>
                                    <option value="1" ng-bind="Language.Resource.CustomerBought"></option>
                                    <option value="2" ng-bind="Language.Resource.CustomerDebit"></option>
                                </select>
                            </div>
                            <div class="col-md-4 pull-right text-right margin-top-5">
                                <button class="btn btn-success btn-primary" data-toggle="modal"
                                        data-target="#customerModal" ng-click="SetIsSaleCustomer('0')"
                                        ng-if="CustomerFormConfig._CanCreate">
                                    <i class="fa fa-plus white"></i>
                                    <span ng-bind="Language.Resource.CreateCustomer"></span>
                                </button>
                                <span grid-export-import-for="Customers" grid-export-template="Customers.xlsx"></span>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table grid-data="Customers"
                                   grid-data-type="table" @*table/storedprocedure*@
                                   grid-data-action="get" @*get/getall*@
                                   grid-data-object="T_Master_Customers" @*table name or stored procedure name*@
                                   grid-filter-condition="[IsWholeSale] = 0 and [IsActive] = 1 and ({{AdditionalFilter.CustomerType}} = 0
                                                or ({{AdditionalFilter.CustomerType}} = 1 and  [LastTimeVisited] is not null)
                                                or ({{AdditionalFilter.CustomerType}} = 2 and [Debt] > 0))" @*must have [fieldname] for each colum field*@
                                   grid-sort-condition="[CustomerCode] ASC" @*must have [fieldname] for each colum field*@
                                   grid-sum-collection="[SumMoney];[Debt]" @*must have [fieldname] for each colum field*@
                                   class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th grid-defined-colum="!CustomerId" class="none-display"></th>
                                        <th grid-defined-colum="CustomerCode"><span ng-bind="Language.Resource.CustomerCode"></span></th>
                                        <th grid-defined-colum="CustomerName"><span ng-bind="Language.Resource.CustomerName"></span></th>
                                        <th grid-defined-colum="Phone"><span ng-bind="Language.Resource.Phone"></span></th>
                                        <th grid-defined-colum="Address"><span ng-bind="Language.Resource.Address"></span></th>
                                        <th grid-defined-colum="LastTimeVisited"><span ng-bind="Language.Resource.LastBoughtDate"></span></th>
                                        <th grid-defined-colum="SumMoney"><span ng-bind="Language.Resource.SumMoney"></span></th>
                                        <th grid-defined-colum="Debt"><span ng-bind="Language.Resource.Debit"></span></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*Dataset must have grid id*@
                                    <tr ng-repeat="item in DataSet.Customers.Data">
                                        <td> <a href="#" ng-click="ShowCustomerDetail(item)" ng-bind="item.CustomerCode"></a> </td>
                                        <td> <a href="#" ng-click="ShowCustomerDetail(item)" ng-bind="item.CustomerName"></a></td>
                                        <td ng-bind="item.Phone"></td>
                                        <td ng-bind="item.Address"></td>
                                        <td ng-bind="item.LastTimeVisited"></td>
                                        <td ng-bind="item.SumMoney | currency:'':0"></td>
                                        <td ng-bind="item.Debt | currency:'':0"></td>
                                        <td>
                                            <a class="red margin-left-10" ng-click="DeleteCustomer(item, 0)" ng-if="item._CanDelete">
                                                <i class="fa-trash fa"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    <tr ng-if="!DataSet.Customers.HasRecord()">
                                        @*Edit colspan*@
                                        <td colspan="8" align="center" ng-bind="Language.Resource.NoDataFound"></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="8" align="left">
                                            <div style="float: left;">
                                                <span ng-bind="Language.Resource.NumCustomer"></span> : <span class="total-highlight" ng-bind="DataSet.Customers.TotalItems"></span>
                                                <span ng-bind="Language.Resource.SumMoney"></span> : <span class="total-highlight"><span ng-bind="DataSet.Customers.Sums.SumMoney | currency:'':0"></span> đ</span>
                                                <span ng-bind="Language.Resource.Debit"></span> : <span class="total-highlight"><span ng-bind="DataSet.Customers.Sums.Debt | currency:'':0"></span> đ</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col-md-9">
                                <span grid-paging-for="Customers"></span>
                            </div>

                            <div class="col-md-3">
                                <span grid-page-size-for="Customers"></span>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="tab-pane" ng-class="{active : (CurrentTab =='SaleCustomers') && !IsShowCustomerDetail }">
                    <div class="col-md-12" ng-if="(CurrentTab =='SaleCustomers') && !IsShowCustomerDetail">
                        <div class="row" style="padding-bottom: 10px; padding-top: 5px">
                            <div class="col-md-5 margin-top-5">
                                <span grid-filter-for="SaleCustomers" place-holder-message="{{Language.Resource.PlaceholderCustomer}}"></span>
                            </div>
                            <div class="col-md-2 margin-top-5">
                                <select class="form-control input-sm" ng-model="AdditionalFilter.SaleCustomerType" ng-change="ReloadGrid('SaleCustomers')">
                                    <option selected="selected" value="0" ng-bind="Language.Resource.All"></option>
                                    <option value="1" ng-bind="Language.Resource.CustomerBought"></option>
                                    <option value="2" ng-bind="Language.Resource.CustomerDebit"></option>
                                </select>
                            </div>
                            <div class="col-md-4 pull-right text-right margin-top-5">
                                <button class="btn btn-success btn-primary" data-toggle="modal"
                                        data-target="#customerModal" ng-click="SetIsSaleCustomer('1')"
                                        ng-if="CustomerFormConfig._CanCreate">
                                    <i class="fa fa-plus white"></i>
                                    <span ng-bind="Language.Resource.CreateCustomerSale"></span>
                                </button>
                                <span grid-export-import-for="SaleCustomers" grid-export-template="Customers.xlsx"></span>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table grid-data="SaleCustomers"
                                   grid-data-type="table" @*table/storedprocedure*@
                                   grid-data-action="get" @*get/getall*@
                                   grid-data-object="T_Master_Customers" @*table name or stored procedure name*@
                                   grid-filter-condition="[IsWholeSale] = 1 and [IsActive] = 1 and ({{AdditionalFilter.SaleCustomerType}} = 0
                                                or ({{AdditionalFilter.SaleCustomerType}} = 1 and  [LastTimeVisited] is not null)
                                                or ({{AdditionalFilter.SaleCustomerType}} = 2 and [Debt] > 0))" @*must have [fieldname] for each colum field*@
                                   grid-sort-condition="[CustomerCode] ASC" @*must have [fieldname] for each colum field*@
                                   grid-sum-collection="[SumMoney];[Debt]" @*must have [fieldname] for each colum field*@
                                   class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th grid-defined-colum="!CustomerId" class="none-display"></th>
                                        <th grid-defined-colum="CustomerCode"><span ng-bind="Language.Resource.CustomerCode"></span></th>
                                        <th grid-defined-colum="CustomerName"><span ng-bind="Language.Resource.CustomerName"></span></th>
                                        <th grid-defined-colum="Phone"><span ng-bind="Language.Resource.Phone"></span></th>
                                        <th grid-defined-colum="Address"><span ng-bind="Language.Resource.Address"></span></th>
                                        <th grid-defined-colum="LastTimeVisited"><span ng-bind="Language.Resource.LastBoughtDate"></span></th>
                                        <th grid-defined-colum="SumMoney"><span ng-bind="Language.Resource.SumMoney"></span></th>
                                        <th grid-defined-colum="Debt"><span ng-bind="Language.Resource.Debit"></span></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*Dataset must have grid id*@
                                    <tr ng-repeat="item in DataSet.SaleCustomers.Data">
                                        <td> <a href="#" ng-click="ShowCustomerDetail(item)" ng-bind="item.CustomerCode"></a> </td>
                                        <td> <a href="#" ng-click="ShowCustomerDetail(item)" ng-bind="item.CustomerName"></a></td>
                                        <td ng-bind="item.Phone"></td>
                                        <td ng-bind="item.Address"></td>
                                        <td ng-bind="item.LastTimeVisited"></td>
                                        <td ng-bind="item.SumMoney | currency:'':0"></td>
                                        <td ng-bind="item.Debt | currency:'':0"></td>
                                        <td>
                                            <a class="red margin-left-10" ng-click="DeleteCustomer(item, 1)" ng-if="item._CanDelete">
                                                <i class="fa-trash fa"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    <tr ng-if="!DataSet.SaleCustomers.HasRecord()">
                                        @*Edit colspan*@
                                        <td colspan="8" align="center" ng-bind="Language.Resource.NoDataFound"></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="8" align="left">
                                            <div style="float: left;">
                                                <span ng-bind="Language.Resource.NumCustomer"></span> : <span class="total-highlight" ng-bind="DataSet.SaleCustomers.TotalItems"></span>
                                                <span ng-bind="Language.Resource.SumMoney"></span> : <span class="total-highlight"><span ng-bind="DataSet.SaleCustomers.Sums.SumMoney | currency:'':0"></span> đ</span>
                                                <span ng-bind="Language.Resource.Debit"></span> : <span class="total-highlight"><span ng-bind="DataSet.SaleCustomers.Sums.Debt | currency:'':0"></span> đ</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col-md-9">
                                <span grid-paging-for="SaleCustomers"></span>
                            </div>

                            <div class="col-md-3">
                                <span grid-page-size-for="SaleCustomers"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" ng-class="{active : ((CurrentTab =='Customers' || CurrentTab =='SaleCustomers') && IsShowCustomerDetail) }">
                    <div class="col-md-12" ng-show="((CurrentTab =='Customers' || CurrentTab =='SaleCustomers') && IsShowCustomerDetail)"
                         ng-include src="'@Url.Action("CustomerDetail", "Admin")'">
                    </div>
                </div>
                <div class="tab-pane" ng-class="{active : (CurrentTab =='Suppliers') && !IsShowSupplierDetail }">
                    <div class="col-md-12" ng-if="(CurrentTab =='Suppliers') && !IsShowSupplierDetail">
                        <div class="row" style="padding-bottom: 10px; padding-top: 5px">
                            <div class="col-md-5 margin-top-5">
                                <span grid-filter-for="Suppliers" place-holder-message="{{Language.Resource.PlaceholderSupplier}}"></span>
                            </div>
                            <div class="col-md-2 margin-top-5">
                                <select class="form-control input-sm" ng-model="AdditionalFilter.SupplierType" ng-change="ReloadGrid('Suppliers')">
                                    <option selected="selected" value="0" ng-bind="Language.Resource.All"></option>
                                    <option value="1" ng-bind="Language.Resource.SupplierProvide"></option>
                                    <option value="2" ng-bind="Language.Resource.SupplierDebit"></option>
                                </select>
                            </div>
                            <div class="col-md-4 pull-right text-right margin-top-5">
                                <button class="btn btn-success btn-primary" data-toggle="modal"
                                        data-target="#supplierModal" ng-click="InitSupplier()"
                                        ng-if="SupplierFormConfig._CanCreate">
                                    <i class="fa fa-plus white"></i>
                                    <span ng-bind="Language.Resource.CreateSupplier"></span>
                                </button>
                                <span grid-export-import-for="Suppliers" grid-export-template="Suppliers.xlsx"></span>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table grid-data="Suppliers"
                                   grid-data-type="table" @*table/storedprocedure*@
                                   grid-data-action="get" @*get/getall*@
                                   grid-data-object="T_Master_Suppliers" @*table name or stored procedure name*@
                                   grid-filter-condition="[IsActive] = 1 and ({{AdditionalFilter.SupplierType}} = 0
                                                or ({{AdditionalFilter.SupplierType}} = 1 and  [LastTimeProvided] is not null)
                                                or ({{AdditionalFilter.SupplierType}} = 2 and [Debt] > 0))" @*must have [fieldname] for each colum field*@
                                   grid-sort-condition="[SupplierCode] ASC" @*must have [fieldname] for each colum field*@
                                   grid-sum-collection="[SumMoney];[Debt]" @*must have [fieldname] for each colum field*@
                                   class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th grid-defined-colum="!SupplierId" class="none-display"></th>
                                        <th grid-defined-colum="SupplierCode"><span ng-bind="Language.Resource.SupplierCode"></span></th>
                                        <th grid-defined-colum="SupplierName"><span ng-bind="Language.Resource.SupplierName"></span></th>
                                        <th grid-defined-colum="Phone"><span ng-bind="Language.Resource.Phone"></span></th>
                                        <th grid-defined-colum="Address"><span ng-bind="Language.Resource.Address"></span></th>
                                        <th grid-defined-colum="LastTimeProvided"><span ng-bind="Language.Resource.LastBoughtDate"></span></th>
                                        <th grid-defined-colum="SumMoney"><span ng-bind="Language.Resource.SumMoney"></span></th>
                                        <th grid-defined-colum="Debt"><span ng-bind="Language.Resource.Debit"></span></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*Dataset must have grid id*@
                                    <tr ng-repeat="item in DataSet.Suppliers.Data">
                                        <td> <a href="#" ng-click="ShowSupplierDetail(item)" ng-bind="item.SupplierCode"></a> </td>
                                        <td> <a href="#" ng-click="ShowSupplierDetail(item)" ng-bind="item.SupplierName"></a></td>
                                        <td ng-bind="item.Phone"></td>
                                        <td ng-bind="item.Address"></td>
                                        <td ng-bind="item.LastTimeProvided"></td>
                                        <td ng-bind="item.SumMoney | currency:'':0"></td>
                                        <td ng-bind="item.Debt | currency:'':0"></td>
                                        <td>
                                            <a class="red margin-left-10" ng-click="DeleteSupplier(item)" ng-if="item._CanDelete">
                                                <i class="fa-trash fa"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    <tr ng-if="!DataSet.Suppliers.HasRecord()">
                                        @*Edit colspan*@
                                        <td colspan="8" align="center" ng-bind="Language.Resource.NoDataFound"></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="8" align="left">
                                            <div style="float: left;">
                                                <span ng-bind="Language.Resource.NumSupplier"></span> : <span class="total-highlight" ng-bind="DataSet.Suppliers.TotalItems"></span>
                                                <span ng-bind="Language.Resource.SumMoney"></span> : <span class="total-highlight"><span ng-bind="DataSet.Suppliers.Sums.SumMoney | currency:'':0"></span> đ</span>
                                                <span ng-bind="Language.Resource.Debit"></span> : <span class="total-highlight"><span ng-bind="DataSet.Suppliers.Sums.Debt | currency:'':0"></span> đ</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col-md-9">
                                <span grid-paging-for="Suppliers"></span>
                            </div>

                            <div class="col-md-3">
                                <span grid-page-size-for="Suppliers"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" ng-class="{active : (CurrentTab =='Suppliers' && IsShowSupplierDetail) }">
                    <div class="col-md-12" ng-show="(CurrentTab =='Suppliers' && IsShowSupplierDetail)" ng-include src="'@Url.Action("SupplierDetail", "Admin")'">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ng-include src="'@Url.Action("CustomerModal", "Admin")'">
    </div>
    <div ng-include src="'@Url.Action("SupplierModal", "Admin")'">
    </div>
</div>


